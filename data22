            if "parties" in response_data and isinstance(response_data["parties"], list):
                for party in response_data["parties"]:
                    name = party.get("fullName") if "fullName" in party else party.get("firstName")
                    extracted_data.append({
                        "type": party.get("type"),
                        "name": name.strip() if name else None,
                        "country": party.get("country").strip() if party.get("country") else None
                    })
    
    df = pd.DataFrame(extracted_data)
    df.to_excel(output_excel_path, index=False)
    print("Response data written to Excel successfully.")
